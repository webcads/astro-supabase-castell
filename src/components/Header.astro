---
// Header.astro
import clientData from "../config/clientData.json";
import ThemeIcon from "./ui/ThemeIcon.astro";
const headerNavs = [
  { url: "/kit", label: "kit" },
  { url: "/carnetdigital", label: "carnet digital" },
  { url: "/formatos", label: "formatos" },
  { url: "/links", label: "links" },
  { url: "/dev", label: "dev" },  
  { url: "/api/signin", label: "iniciar sesion" },    
  // {"url": "/gallery", "label": "Gallery"},
  // {"url": "/testimonials", "label": "Testimonials"}
];
---

<style>
  header {
    transition: all 0.2s;
    outline: none;
    border: none;
  }

  .mobile-menu-container {
    transition: all 2s;
  }

  /* Media query for mobile devices */
  @media (max-width: 768px) {
  }

  /* Media query for desktop devices */
  @media (min-width: 768px) {
    header {
      bottom: auto;
    }
  }
</style>

<header transition:persist
  class="bg-white md:bottom-auto bottom-0 w-full fixed z-40 border-gray-200 dark:bg-gray-900 text-secondary dark:text-primary"
>
  <div
    class="max-w-screen flex flex-wrap items-center justify-between mx-10 p-4"
  >
    <a href="/" class="flex items-center space-x-3 rtl:space-x-reverse">
      <svg
        xmlns="http://www.w3.org/2000/svg"
        width="3em"
        height="3em"
        viewBox="0 0 20 20"
        ><path
          fill="currentColor"
          d="M8.7 7A1.7 1.7 0 0 0 7 8.7A1.3 1.3 0 0 0 8.3 10h3.4A1.3 1.3 0 0 0 13 8.7A1.7 1.7 0 0 0 11.3 7zM8 8.7a.7.7 0 0 1 .7-.7h2.6a.7.7 0 0 1 .7.7a.3.3 0 0 1-.3.3H8.3a.3.3 0 0 1-.3-.3M10 2a2.5 2.5 0 0 0-2.5 2.5v.044A6.001 6.001 0 0 0 4 10v5a3 3 0 0 0 3 3h6a3 3 0 0 0 3-3v-5a6.001 6.001 0 0 0-3.5-5.456V4.5A2.5 2.5 0 0 0 10 2m5 10H5v-2a5 5 0 0 1 10 0zm-8 2.5a.5.5 0 0 0 1 0V13h7v2a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-2h2zM10 4a6.05 6.05 0 0 0-1.466.18a1.5 1.5 0 0 1 2.932 0C10.996 4.063 10.506 4 10 4"
        ></path></svg
      >
      <span
        class="self-center text-2xl font-semibold whitespace-nowrap dark:text-white"
      >
        {clientData.web_name}</span
      >
    </a>
    <!-- toogle navbar mobiles -->
    <button
      id="mobile-menu-toggle"
      type="button"
      class="inline-flex items-center p-2 w-10 h-10 justify-center text-sm text-gray-500 rounded-lg md:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600"
    >
      <span class="sr-only">Open main menu</span>
      <svg
        class="w-5 h-5"
        aria-hidden="true"
        xmlns="http://www.w3.org/2000/svg"
        fill="none"
        viewBox="0 0 17 14"
      >
        <path
          stroke="currentColor"
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M1 1h15M1 7h15M1 13h15"></path>
      </svg>
    </button>

    <div class="hidden w-full md:block md:w-auto" id="navbar-default">
      <ul
        class="font-medium flex flex-col p-4 md:p-0 mt-4 border border-gray-100 rounded-lg md:flex-row md:space-x-8 rtl:space-x-reverse md:mt-0 md:border-0 dark:border-gray-700"
      >
        <li>
          <a
            href="/"
            class="block py-2 px-3 text-third rounded md:bg-transparent md:text-secondary md:p-0 dark:text-white"
            aria-current="page"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="1.5em"
              height="1.5em"
              viewBox="0 0 24 24"
              ><rect
                width="4"
                height="8"
                x="10"
                y="13"
                fill="currentColor"
                fill-opacity="0"
                ><animate
                  fill="freeze"
                  attributeName="fill-opacity"
                  begin="0.9s"
                  dur="0.15s"
                  values="0;0.3"></animate></rect
              ><g
                fill="none"
                stroke="currentColor"
                stroke-linecap="round"
                stroke-linejoin="round"
                ><path
                  stroke-dasharray="15"
                  stroke-dashoffset="15"
                  d="M4.5 21.5h15"
                  ><animate
                    fill="freeze"
                    attributeName="stroke-dashoffset"
                    dur="0.2s"
                    values="15;0"></animate></path
                ><path
                  stroke-dasharray="15"
                  stroke-dashoffset="15"
                  d="M4.5 21.5V8M19.5 21.5V8"
                  ><animate
                    fill="freeze"
                    attributeName="stroke-dashoffset"
                    begin="0.2s"
                    dur="0.2s"
                    values="15;0"></animate></path
                ><path
                  stroke-dasharray="24"
                  stroke-dashoffset="24"
                  d="M9.5 21.5V12.5H14.5V21.5"
                  ><animate
                    fill="freeze"
                    attributeName="stroke-dashoffset"
                    begin="0.4s"
                    dur="0.4s"
                    values="24;0"></animate></path
                ><path
                  stroke-dasharray="30"
                  stroke-dashoffset="30"
                  stroke-width="2"
                  d="M2 10L12 2L22 10"
                  ><animate
                    fill="freeze"
                    attributeName="stroke-dashoffset"
                    begin="0.5s"
                    dur="0.4s"
                    values="30;0"></animate></path
                ></g
              ></svg
            >
          </a>
        </li>
        {
          headerNavs.map((nav) => (
            <li>
              <a
                href={nav.url}
                class="block py-2 capitalize px-3 text-secondary  rounded md:bg-transparent  md:p-0 dark:text-white"
                aria-current="page"
                style="    text-transform: capitalize;"
              >
                {nav.label}
              </a>
            </li>
          ))
        }
        <!-- dark mode toggle button -->
        <ThemeIcon />
      </ul>
    </div>
  </div>
</header>

<script is:inline>
  function hiddeNavbar() {
    var header = document.querySelector("header");
    var lastScrollTop = 0;

    window.addEventListener("scroll", function () {
      var st = window.pageYOffset || document.documentElement.scrollTop;
      var isMobile = window.innerWidth <= 768;

      if (st > lastScrollTop) {
        // Desplazamiento hacia abajo
        header.style.transform = isMobile
          ? "translateY(100%)"
          : "translateY(-100%)";
      } else {
        // Desplazamiento hacia arriba
        header.style.transform = isMobile ? "translateY(0)" : "translateY(0%)";
      }

      lastScrollTop = st;
    });
  }

  function toggleShowNavMobil() {
    // Agregar un event listener para el clic en el botón de alternancia del menú móvil
    var navbarToggle = document.getElementById("mobile-menu-toggle"); // Seleccionar el botón por su id
    navbarToggle.addEventListener("click", function () {
      var navbar = document.getElementById("navbar-default");
      navbar.classList.toggle("hidden"); // Alternar la clase 'hidden' para mostrar/ocultar el menú});
    });
  }


  window.addEventListener("DOMContentLoaded", function () {
  toggleShowNavMobil();    
  hiddeNavbar();  
  }); 

//   document.addEventListener('astro:page-load', () => {     
//    toggleShowNavMobil();    
//    hiddeNavbar();
  
//  });
  document.addEventListener("astro:after-swap", () => {
    toggleShowNavMobil();
    hiddeNavbar();    
   
  });
</script>
